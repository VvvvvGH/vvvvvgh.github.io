import{_ as s}from"./plugin-vue_export-helper-DlAUqK2U.js";import{c as n,b as a,o as i}from"./app-CJlMl9Ja.js";const t={};function p(r,e){return i(),n("div",null,e[0]||(e[0]=[a(`<h1 id="前言" tabindex="-1"><a class="header-anchor" href="#前言"><span>前言</span></a></h1><p>博客已经许久没有更新，现在更新下 使用了 新的vps，启用ssl http2 。</p><p>那么久不更新博客，主要是懒了， 平时学的东西习惯记到纸上，很少会想起有个博客可以记些东西。</p><h1 id="vps配置" tabindex="-1"><a class="header-anchor" href="#vps配置"><span>VPS配置</span></a></h1><h2 id="nginx" tabindex="-1"><a class="header-anchor" href="#nginx"><span>Nginx</span></a></h2><p>我的VPS是debian9 的系统</p><p>添加nginx的官方源</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-"><span class="line"><span>deb http://nginx.org/packages/debian/ stretch nginx</span></span>
<span class="line"><span>deb-src http://nginx.org/packages/debian/ stretch nginx</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>导入KEY 然后安装nginx</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-"><span class="line"><span>wget http://nginx.org/keys/nginx_signing.key &amp;&amp; apt-key add nginx_signing.key</span></span>
<span class="line"><span>apt-get update &amp;&amp; apt-get install nginx</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>启动nginx</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-"><span class="line"><span>services nginx start</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h2 id="配置nginx" tabindex="-1"><a class="header-anchor" href="#配置nginx"><span>配置nginx</span></a></h2><blockquote><p>配置文件路径 /etc/nginx/nginx.conf</p></blockquote><p>添加以下内容 然后重启nginx服务</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-"><span class="line"><span>server</span></span>
<span class="line"><span>{</span></span>
<span class="line"><span>    listen 80;</span></span>
<span class="line"><span>    server_name vistazx1.top;</span></span>
<span class="line"><span>    index index.html index.htm index.php default.html default.htm default.php;</span></span>
<span class="line"><span>    root  /www/hexo;  </span></span>
<span class="line"><span></span></span>
<span class="line"><span>    #error_page   404   /404.html;</span></span>
<span class="line"><span>    location ~ .*\\.(ico|gif|jpg|jpeg|png|bmp|swf)$</span></span>
<span class="line"><span>    {</span></span>
<span class="line"><span>        access_log   off;</span></span>
<span class="line"><span>        expires      1d;</span></span>
<span class="line"><span>    }</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    location ~ .*\\.(js|css|txt|xml)?$</span></span>
<span class="line"><span>    {</span></span>
<span class="line"><span>        access_log   off;</span></span>
<span class="line"><span>        expires      12h;</span></span>
<span class="line"><span>    }</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    location / {</span></span>
<span class="line"><span>        try_files $uri $uri/ =404;</span></span>
<span class="line"><span>    }</span></span>
<span class="line"><span></span></span>
<span class="line"><span>}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h2 id="用let-s-encrypt-生成证书" tabindex="-1"><a class="header-anchor" href="#用let-s-encrypt-生成证书"><span>用Let&#39;s Encrypt 生成证书</span></a></h2><div class="tip"> 此时应该先做好域名的dns解析，否则很可能无法通过。 </div><p>打开certbot <a href="https://certbot.eff.org/" target="_blank" rel="noopener noreferrer">https://certbot.eff.org/</a> 选择好系统和软件，跟着步骤来即可</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-"><span class="line"><span>apt-get install certbot </span></span>
<span class="line"><span>certbot certonly</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>很快就会提示成功</p><h2 id="证书自动续签" tabindex="-1"><a class="header-anchor" href="#证书自动续签"><span>证书自动续签</span></a></h2><p>由于证书只有90天的有效期，不可能总会记得续签这回事</p><p>先验证是否可以续签</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-"><span class="line"><span>certbot renew --dry-run</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><blockquote><p>Congratulations, all renewals succeeded. The following certs have been renewed</p></blockquote><p>成功，接下来可以配置crontab</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-"><span class="line"><span>crontab -e</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>添加即可</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-"><span class="line"><span>0 3 1 * * /usr/bin/certbot renew #每月一日三点renew</span></span>
<span class="line"><span>1 3 1 * * service nginx restart # renew 后重启nginx</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h2 id="启用ssl" tabindex="-1"><a class="header-anchor" href="#启用ssl"><span>启用SSl</span></a></h2><p>在这里推荐一个网页，可以按要求自动生成你需要的配置文件 <a href="https://mozilla.github.io/server-side-tls/ssl-config-generator/" target="_blank" rel="noopener noreferrer">Mozilla SSL Configuration Generator</a><img src="https://cdn.vistazx1.top/images/202409281716610.webp" alt="Mozilla SSL Configuration"></p><p>生成2048位的DH-Key（证书密钥交换密钥） 会用很长时间</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-"><span class="line"><span>openssl dhparam -out /etc/ssl/certs/dhparam.pem 2048</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>更新nginx配置文件<br> 按需求复制粘贴即可<br> 需要手动修改的是以下几项</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-"><span class="line"><span>    ssl_certificate /path/to/signed_cert_plus_intermediates;</span></span>
<span class="line"><span>    ssl_certificate_key /path/to/private_key;</span></span>
<span class="line"><span>    # Diffie-Hellman parameter for DHE ciphersuites, recommended 2048 bits</span></span>
<span class="line"><span>    ssl_dhparam /path/to/dhparam.pem;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>重启nginx 配置完成</p>`,37)]))}const o=s(t,[["render",p]]),d=JSON.parse(`{"path":"/posts/2017-09-20-vps-configuration.html","title":"更换vps以及相关配置","lang":"zh-CN","frontmatter":{"title":"更换vps以及相关配置","date":"2017-09-20T00:00:00.000Z","category":["VPS","服务器配置","技术开发"],"tag":["VPS配置","Nginx","SSL证书","Let's Encrypt","Certbot","自动续签","HTTPS","Debian","域名解析","安全配置"],"file_name":"2017-09-20-vps-configuration.md","description":"前言 博客已经许久没有更新，现在更新下 使用了 新的vps，启用ssl http2 。 那么久不更新博客，主要是懒了， 平时学的东西习惯记到纸上，很少会想起有个博客可以记些东西。 VPS配置 Nginx 我的VPS是debian9 的系统 添加nginx的官方源 导入KEY 然后安装nginx 启动nginx 配置nginx 配置文件路径 /etc/n...","head":[["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"更换vps以及相关配置\\",\\"image\\":[\\"https://cdn.vistazx1.top/images/202409281716610.webp\\"],\\"datePublished\\":\\"2017-09-20T00:00:00.000Z\\",\\"dateModified\\":\\"2024-09-29T15:21:40.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"Guohao\\",\\"url\\":\\"https://space.vistazx1.top\\"}]}"],["meta",{"property":"og:url","content":"https://space.vistazx1.top/posts/2017-09-20-vps-configuration.html"}],["meta",{"property":"og:site_name","content":"Vista"}],["meta",{"property":"og:title","content":"更换vps以及相关配置"}],["meta",{"property":"og:description","content":"前言 博客已经许久没有更新，现在更新下 使用了 新的vps，启用ssl http2 。 那么久不更新博客，主要是懒了， 平时学的东西习惯记到纸上，很少会想起有个博客可以记些东西。 VPS配置 Nginx 我的VPS是debian9 的系统 添加nginx的官方源 导入KEY 然后安装nginx 启动nginx 配置nginx 配置文件路径 /etc/n..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:image","content":"https://cdn.vistazx1.top/images/202409281716610.webp"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2024-09-29T15:21:40.000Z"}],["meta",{"property":"article:tag","content":"安全配置"}],["meta",{"property":"article:tag","content":"域名解析"}],["meta",{"property":"article:tag","content":"Debian"}],["meta",{"property":"article:tag","content":"HTTPS"}],["meta",{"property":"article:tag","content":"自动续签"}],["meta",{"property":"article:tag","content":"Certbot"}],["meta",{"property":"article:tag","content":"Let's Encrypt"}],["meta",{"property":"article:tag","content":"SSL证书"}],["meta",{"property":"article:tag","content":"Nginx"}],["meta",{"property":"article:tag","content":"VPS配置"}],["meta",{"property":"article:published_time","content":"2017-09-20T00:00:00.000Z"}],["meta",{"property":"article:modified_time","content":"2024-09-29T15:21:40.000Z"}]]},"git":{"createdTime":1727623300000,"updatedTime":1727623300000,"contributors":[{"name":"root","username":"root","email":"root@vistazx1.top","commits":1,"url":"https://github.com/root"}]},"readingTime":{"minutes":1.78,"words":535},"filePathRelative":"posts/2017-09-20-vps-configuration.md","excerpt":"\\n<p>博客已经许久没有更新，现在更新下 使用了 新的vps，启用ssl http2 。</p>\\n<p>那么久不更新博客，主要是懒了， 平时学的东西习惯记到纸上，很少会想起有个博客可以记些东西。</p>\\n<h1>VPS配置</h1>\\n<h2>Nginx</h2>\\n<p>我的VPS是debian9 的系统</p>\\n<p>添加nginx的官方源</p>\\n<div class=\\"language- line-numbers-mode\\" data-highlighter=\\"shiki\\" data-ext=\\"\\" style=\\"--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34\\"><pre class=\\"shiki shiki-themes one-light one-dark-pro vp-code\\"><code class=\\"language-\\"><span class=\\"line\\"><span>deb http://nginx.org/packages/debian/ stretch nginx</span></span>\\n<span class=\\"line\\"><span>deb-src http://nginx.org/packages/debian/ stretch nginx</span></span></code></pre>\\n<div class=\\"line-numbers\\" aria-hidden=\\"true\\" style=\\"counter-reset:line-number 0\\"><div class=\\"line-number\\"></div></div></div>","autoDesc":true}`);export{o as comp,d as data};
