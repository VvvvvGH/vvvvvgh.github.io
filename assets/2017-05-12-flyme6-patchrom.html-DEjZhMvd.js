import{_ as a}from"./plugin-vue_export-helper-DlAUqK2U.js";import{c as t,b as s,o as n}from"./app-CJlMl9Ja.js";const i={};function r(o,e){return n(),t("div",null,e[0]||(e[0]=[s(`<h2 id="基于jdc-aosp" tabindex="-1"><a class="header-anchor" href="#基于jdc-aosp"><span>基于JDC-AOSP</span></a></h2><p>本来不想搞编译，无奈现有的AOSP底包并不令人满意，恰好JDC-TEAM有现成的Device Tree。就打算重新编译一下，加点优化。做个满意的底包。</p><h2 id="遇到的问题与解决" tabindex="-1"><a class="header-anchor" href="#遇到的问题与解决"><span>遇到的问题与解决</span></a></h2><h3 id="问题-zygote-not-whitelisted" tabindex="-1"><a class="header-anchor" href="#问题-zygote-not-whitelisted"><span>问题 Zygote Not whitelisted :</span></a></h3><p>原因是谷歌新的安全补丁加入了白名单</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-"><span class="line"><span>05-11 20:24:25.408  3346  3346 E Zygote  : Not whitelisted : /system/framework/flyme-res/flyme-res.apk</span></span>
<span class="line"><span>05-11 20:24:25.408  3346  3346 F art     : art/runtime/jni_internal.cc:497] JNI FatalError called: frameworks/base/core/jni/com_android_internal_os_Zygote.cpp:478: Unable to construct file descriptor table.</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h4 id="解决方案" tabindex="-1"><a class="header-anchor" href="#解决方案"><span>解决方案</span></a></h4><p>修改安卓源码　com_android_internal_os_Zygote.cpp　删除导致崩溃的部分</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-"><span class="line"><span>if (gOpenFdTable == NULL) {</span></span>
<span class="line"><span>    gOpenFdTable = FileDescriptorTable::Create();</span></span>
<span class="line"><span>    if (gOpenFdTable == NULL) {</span></span>
<span class="line"><span>      RuntimeAbort(env, __LINE__, &quot;Unable to construct file descriptor table.&quot;);</span></span>
<span class="line"><span>    }</span></span>
<span class="line"><span>  } else if (!gOpenFdTable-&gt;Restat()) {</span></span>
<span class="line"><span>    RuntimeAbort(env, __LINE__, &quot;Unable to restat file descriptor table.&quot;);</span></span>
<span class="line"><span>  }</span></span>
<span class="line"><span></span></span>
<span class="line"><span></span></span>
<span class="line"><span>if (!gOpenFdTable-&gt;ReopenOrDetach()) {</span></span>
<span class="line"><span>    RuntimeAbort(env, __LINE__, &quot;Unable to reopen whitelisted descriptors.&quot;);</span></span>
<span class="line"><span>    }</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h3 id="寄存器超过15" tabindex="-1"><a class="header-anchor" href="#寄存器超过15"><span>寄存器超过15</span></a></h3><p>使用以下尝试转换</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-"><span class="line"><span>move/from16 B, A</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>出现from16的情况一般是一个方法里使用的寄存器超过15个<br> Ｂ是目的寄存器<br> 最后别忘了move-result</p>`,13)]))}const c=a(i,[["render",r]]),d=JSON.parse('{"path":"/posts/2017-05-12-flyme6-patchrom.html","title":"Flyme6 Patchrom 项目笔记","lang":"zh-CN","frontmatter":{"title":"Flyme6 Patchrom 项目笔记","date":"2017-05-12T00:00:00.000Z","category":["安卓开发","Flyme","技术笔记"],"tag":["JDC-AOSP","Zygote","白名单问题","安卓源码修改","寄存器优化","Flyme6","Patchrom","文件描述符表","JNI错误处理","方法寄存器"],"file_name":"2017-05-12-flyme6-patchrom.md","description":"基于JDC-AOSP 本来不想搞编译，无奈现有的AOSP底包并不令人满意，恰好JDC-TEAM有现成的Device Tree。就打算重新编译一下，加点优化。做个满意的底包。 遇到的问题与解决 问题 Zygote Not whitelisted : 原因是谷歌新的安全补丁加入了白名单 解决方案 修改安卓源码 com_android_internal_os...","head":[["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"Flyme6 Patchrom 项目笔记\\",\\"image\\":[\\"\\"],\\"datePublished\\":\\"2017-05-12T00:00:00.000Z\\",\\"dateModified\\":\\"2024-09-29T15:21:40.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"Guohao\\",\\"url\\":\\"https://space.vistazx1.top\\"}]}"],["meta",{"property":"og:url","content":"https://space.vistazx1.top/posts/2017-05-12-flyme6-patchrom.html"}],["meta",{"property":"og:site_name","content":"Vista"}],["meta",{"property":"og:title","content":"Flyme6 Patchrom 项目笔记"}],["meta",{"property":"og:description","content":"基于JDC-AOSP 本来不想搞编译，无奈现有的AOSP底包并不令人满意，恰好JDC-TEAM有现成的Device Tree。就打算重新编译一下，加点优化。做个满意的底包。 遇到的问题与解决 问题 Zygote Not whitelisted : 原因是谷歌新的安全补丁加入了白名单 解决方案 修改安卓源码 com_android_internal_os..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2024-09-29T15:21:40.000Z"}],["meta",{"property":"article:tag","content":"方法寄存器"}],["meta",{"property":"article:tag","content":"JNI错误处理"}],["meta",{"property":"article:tag","content":"文件描述符表"}],["meta",{"property":"article:tag","content":"Patchrom"}],["meta",{"property":"article:tag","content":"Flyme6"}],["meta",{"property":"article:tag","content":"寄存器优化"}],["meta",{"property":"article:tag","content":"安卓源码修改"}],["meta",{"property":"article:tag","content":"白名单问题"}],["meta",{"property":"article:tag","content":"Zygote"}],["meta",{"property":"article:tag","content":"JDC-AOSP"}],["meta",{"property":"article:published_time","content":"2017-05-12T00:00:00.000Z"}],["meta",{"property":"article:modified_time","content":"2024-09-29T15:21:40.000Z"}]]},"git":{"createdTime":1727623300000,"updatedTime":1727623300000,"contributors":[{"name":"root","username":"root","email":"root@vistazx1.top","commits":1,"url":"https://github.com/root"}]},"readingTime":{"minutes":1.01,"words":302},"filePathRelative":"posts/2017-05-12-flyme6-patchrom.md","excerpt":"<h2>基于JDC-AOSP</h2>\\n<p>本来不想搞编译，无奈现有的AOSP底包并不令人满意，恰好JDC-TEAM有现成的Device Tree。就打算重新编译一下，加点优化。做个满意的底包。</p>\\n<h2>遇到的问题与解决</h2>\\n<h3>问题 Zygote Not whitelisted :</h3>\\n<p>原因是谷歌新的安全补丁加入了白名单</p>\\n<div class=\\"language- line-numbers-mode\\" data-highlighter=\\"shiki\\" data-ext=\\"\\" style=\\"--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34\\"><pre class=\\"shiki shiki-themes one-light one-dark-pro vp-code\\"><code class=\\"language-\\"><span class=\\"line\\"><span>05-11 20:24:25.408  3346  3346 E Zygote  : Not whitelisted : /system/framework/flyme-res/flyme-res.apk</span></span>\\n<span class=\\"line\\"><span>05-11 20:24:25.408  3346  3346 F art     : art/runtime/jni_internal.cc:497] JNI FatalError called: frameworks/base/core/jni/com_android_internal_os_Zygote.cpp:478: Unable to construct file descriptor table.</span></span></code></pre>\\n<div class=\\"line-numbers\\" aria-hidden=\\"true\\" style=\\"counter-reset:line-number 0\\"><div class=\\"line-number\\"></div></div></div>","autoDesc":true}');export{c as comp,d as data};
