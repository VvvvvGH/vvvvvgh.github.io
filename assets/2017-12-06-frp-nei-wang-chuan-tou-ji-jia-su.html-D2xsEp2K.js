import{_ as a}from"./plugin-vue_export-helper-DlAUqK2U.js";import{c as i,b as n,o as t}from"./app-CJlMl9Ja.js";const e={};function p(l,s){return t(),i("div",null,s[0]||(s[0]=[n(`<h1 id="前言" tabindex="-1"><a class="header-anchor" href="#前言"><span>前言</span></a></h1><p>最近用平板搭建了一个小服务器，上面挂了，PT，芒果云文件管理，还打算跑个网页。服务器本地访问速度不错，但是内网穿透后在外网访问速度明显变慢了很多（服务器在米国）。虽然访问没有明显的丢包，只是访问慢，还是得想办法优化下。不然很难在远程传文件。 <strong>文件下载测试：</strong></p><blockquote><p>本地下载测试：20M 远程下载测试：2M</p></blockquote><h1 id="配置" tabindex="-1"><a class="header-anchor" href="#配置"><span>配置</span></a></h1><p><strong>数据流向</strong></p><blockquote><p>外网访问-&gt; nginx -&gt; frps -&gt; frpc -&gt; 内网服务器</p></blockquote><p>虽然是自己用，但还是得保证数据在传输过程的加密。KodeExplorer的登陆密码是明文传输，这让人一点都不省心。 nginx 反向代理frps，绑定域名，使用https。在LetsEncrypt 申请个证书就行。 配置不难，多动手。</p><p>Nginx 配置 (XXXX为frp服务端的vhost_http_port)</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">此处省略。。。</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">	</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">	location</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /status</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> {</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">	proxy_pass</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> http://127.0.0.1:XXXX/</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">	proxy_set_header</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> Host</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> status.tablet</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">	location</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> {</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">	proxy_pass</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> http://127.0.0.1:XXXX/</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">	proxy_set_header</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> Host</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> dashboard.tablet</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">	location</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /cloud</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> {</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">	proxy_pass</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> http://127.0.0.1:XXXX/</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">	proxy_set_header</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> Host</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> cloud.tablet</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>frp服务器配置（privilege_token用于服务端与客户端的认证）</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-"><span class="line"><span>[common]</span></span>
<span class="line"><span>bind_port = XXXX</span></span>
<span class="line"><span>kcp_bind_port = XXXX </span></span>
<span class="line"><span>privilege_token=XXXXXXXXXXXXXXXX</span></span>
<span class="line"><span>vhost_http_port = XXXX</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>frp客户端配置（server_addr是服务器ip， server_port对应frp服务器的bind_port） custom_domains对应 nginx的proxy_set_header 部分</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-"><span class="line"><span>[common]</span></span>
<span class="line"><span></span></span>
<span class="line"><span>server_addr = XXXX</span></span>
<span class="line"><span>server_port = XXXX</span></span>
<span class="line"><span>privilege_token=XXXXXXXXXXXXXX</span></span>
<span class="line"><span></span></span>
<span class="line"><span>[web]</span></span>
<span class="line"><span>type = http</span></span>
<span class="line"><span>local_port = 80</span></span>
<span class="line"><span>custom_domains = cloud.tablet</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h1 id="加速" tabindex="-1"><a class="header-anchor" href="#加速"><span>加速</span></a></h1><p>首先看下frp 的文档。里面提到frp支持kcp协议。赶紧试试。嗯，有不错的提升，看文本文件没问题了。</p><blockquote><p>本地下载测试：20M 启用kcp协议下载测试：6M</p></blockquote><p>但这还是不够，frp文档里提到frp支持http proxy，再加上个代理测试，速度很棒。</p><blockquote><p>本地下载测试：20M frpc加上代理下载测试：20M</p></blockquote><p>此时的数据流向 速度令人满意。OK结束折腾。</p><blockquote><p>外网访问-&gt; nginx -&gt; frps -&gt; ss -&gt; kcptun server -&gt; kcptun client -&gt; ss-windows -&gt; frpc -&gt; 内网服务器</p></blockquote>`,20)]))}const o=a(e,[["render",p]]),c=JSON.parse('{"path":"/posts/2017-12-06-frp-nei-wang-chuan-tou-ji-jia-su.html","title":"frp内网穿透及加速","lang":"zh-CN","frontmatter":{"title":"frp内网穿透及加速","date":"2017-12-06T00:00:00.000Z","category":["网络技术","服务器配置"],"tag":["frp","内网穿透","加速优化","nginx","kcp协议","代理配置","数据加密","远程访问","服务器优化","网络安全"],"file_name":"2017-12-06-frp-nei-wang-chuan-tou-ji-jia-su.md","description":"前言 最近用平板搭建了一个小服务器，上面挂了，PT，芒果云文件管理，还打算跑个网页。服务器本地访问速度不错，但是内网穿透后在外网访问速度明显变慢了很多（服务器在米国）。虽然访问没有明显的丢包，只是访问慢，还是得想办法优化下。不然很难在远程传文件。 文件下载测试： 本地下载测试：20M 远程下载测试：2M 配置 数据流向 外网访问-> nginx -> ...","head":[["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"frp内网穿透及加速\\",\\"image\\":[\\"\\"],\\"datePublished\\":\\"2017-12-06T00:00:00.000Z\\",\\"dateModified\\":\\"2024-09-29T15:21:40.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"Guohao\\",\\"url\\":\\"https://space.vistazx1.top\\"}]}"],["meta",{"property":"og:url","content":"https://space.vistazx1.top/posts/2017-12-06-frp-nei-wang-chuan-tou-ji-jia-su.html"}],["meta",{"property":"og:site_name","content":"Vista"}],["meta",{"property":"og:title","content":"frp内网穿透及加速"}],["meta",{"property":"og:description","content":"前言 最近用平板搭建了一个小服务器，上面挂了，PT，芒果云文件管理，还打算跑个网页。服务器本地访问速度不错，但是内网穿透后在外网访问速度明显变慢了很多（服务器在米国）。虽然访问没有明显的丢包，只是访问慢，还是得想办法优化下。不然很难在远程传文件。 文件下载测试： 本地下载测试：20M 远程下载测试：2M 配置 数据流向 外网访问-> nginx -> ..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2024-09-29T15:21:40.000Z"}],["meta",{"property":"article:tag","content":"网络安全"}],["meta",{"property":"article:tag","content":"服务器优化"}],["meta",{"property":"article:tag","content":"远程访问"}],["meta",{"property":"article:tag","content":"数据加密"}],["meta",{"property":"article:tag","content":"代理配置"}],["meta",{"property":"article:tag","content":"kcp协议"}],["meta",{"property":"article:tag","content":"nginx"}],["meta",{"property":"article:tag","content":"加速优化"}],["meta",{"property":"article:tag","content":"内网穿透"}],["meta",{"property":"article:tag","content":"frp"}],["meta",{"property":"article:published_time","content":"2017-12-06T00:00:00.000Z"}],["meta",{"property":"article:modified_time","content":"2024-09-29T15:21:40.000Z"}]]},"git":{"createdTime":1727623300000,"updatedTime":1727623300000,"contributors":[{"name":"root","username":"root","email":"root@vistazx1.top","commits":1,"url":"https://github.com/root"}]},"readingTime":{"minutes":1.8,"words":541},"filePathRelative":"posts/2017-12-06-frp-nei-wang-chuan-tou-ji-jia-su.md","excerpt":"\\n<p>最近用平板搭建了一个小服务器，上面挂了，PT，芒果云文件管理，还打算跑个网页。服务器本地访问速度不错，但是内网穿透后在外网访问速度明显变慢了很多（服务器在米国）。虽然访问没有明显的丢包，只是访问慢，还是得想办法优化下。不然很难在远程传文件。\\n<strong>文件下载测试：</strong></p>\\n<blockquote>\\n<p>本地下载测试：20M\\n远程下载测试：2M</p>\\n</blockquote>\\n<h1>配置</h1>\\n<p><strong>数据流向</strong></p>\\n<blockquote>\\n<p>外网访问-&gt; nginx -&gt; frps -&gt; frpc -&gt; 内网服务器</p>\\n</blockquote>","autoDesc":true}');export{o as comp,c as data};
